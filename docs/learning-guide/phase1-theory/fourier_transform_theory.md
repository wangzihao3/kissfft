# 傅里叶变换理论

## 概述

本章节将系统地介绍傅里叶变换的理论基础，从连续傅里叶变换到离散傅里叶变换，为后续学习 FFT 算法奠定坚实的数学基础。

## 学习目标

完成本章节后，你应该能够：
- 理解傅里叶变换的物理意义和数学表达
- 掌握连续傅里叶变换（CFT）的定义和性质
- 理解离散傅里叶变换（DFT）的推导过程
- 掌握 DFT 的主要性质和计算方法
- 能够手工计算简单的 DFT 示例

## 目录

1. [傅里叶级数](#1-傅里叶级数)
2. [连续傅里叶变换（CFT）](#2-连续傅里叶变换cft)
3. [离散傅里叶变换（DFT）](#3-离散傅里叶变换dft)
4. [DFT 的性质](#4-dft-的性质)
5. [DFT 计算示例](#5-dft-计算示例)
6. [练习题](#练习题)

---

## 1. 傅里叶级数

### 1.1 基本概念

傅里叶级数告诉我们：**任何周期函数都可以表示为一系列正弦和余弦函数的叠加**。

数学表达：

```
f(t) = a₀/2 + Σ(n=1 to ∞) [aₙcos(nω₀t) + bₙsin(nω₀t)]
```

其中：
- `ω₀ = 2π/T` 是基波角频率
- `T` 是周期
- `aₙ, bₙ` 是傅里叶系数

### 1.2 物理意义

- **时域**：信号随时间的变化
- **频域**：信号包含的频率成分及其强度
- **分解**：复杂信号 → 简单正弦波的叠加

### 1.3 应用示例

**方波的傅里叶级数：**

方波可以表示为：
```
f(t) = (4/π)[sin(ωt) + (1/3)sin(3ωt) + (1/5)sin(5ωt) + ...]
```

这说明：
- 方波由无穷多个奇次谐波组成
- 谐波幅度按 1/n 递减
- 高频谐波使波形更接近理想方波

---

## 2. 连续傅里叶变换（CFT）

### 2.1 定义

傅里叶变换将时域函数转换为频域函数：

**正变换：**
```
F(ω) = ∫(-∞ to ∞) f(t)e^(-jωt) dt
```

**逆变换：**
```
f(t) = (1/2π) ∫(-∞ to ∞) F(ω)e^(jωt) dω
```

### 2.2 欧拉公式

理解傅里叶变换的关键：

```
e^(jθ) = cos(θ) + jsin(θ)

因此：
f(t)e^(-jωt) = f(t)[cos(ωt) - jsin(ωt)]
```

这揭示了傅里叶变换本质上是：
- 将信号投影到不同频率的复指数上
- 实部：与余弦的相似度
- 虚部：与正弦的相似度

### 2.3 频率变量的两种表示

**角频率 ω（rad/s）：**
```
F(ω) = ∫ f(t)e^(-jωt) dt
```

**频率 f（Hz）：**
```
F(f) = ∫ f(t)e^(-j2πft) dt
```

关系：`ω = 2πf`

### 2.4 重要性质

| 性质 | 时域 | 频域 | 说明 |
|------|------|------|------|
| 线性性 | af(t) + bg(t) | aF(ω) + bG(ω) | 叠加原理 |
| 时移 | f(t-t₀) | e^(-jωt₀)F(ω) | 相位变化 |
| 频移 | e^(jω₀t)f(t) | F(ω-ω₀) | 调制定理 |
| 尺度变换 | f(at) | (1/|a|)F(ω/a) | 时间压缩=频谱扩展 |
| 对偶性 | F(t) | 2πf(-ω) | 时频对称 |
| 卷积定理 | f(t) * g(t) | F(ω)G(ω) | 卷积→乘积 |
| Parseval | ∫\|f(t)\|²dt | (1/2π)∫\|F(ω)\|²dω | 能量守恒 |

### 2.5 常见信号的傅里叶变换

**矩形脉冲（门函数）：**
```
f(t) = 1, |t| < T/2
     = 0, 其他

F(ω) = T · sinc(ωT/2)
```

**高斯函数：**
```
f(t) = e^(-αt²)
F(ω) = √(π/α) · e^(-ω²/4α)  （高斯函数的傅里叶变换仍是高斯）
```

---

## 3. 离散傅里叶变换（DFT）

### 3.1 从 CFT 到 DFT

**问题**：计算机处理的是离散数据，如何对离散序列进行频域分析？

**解决**：
1. **离散化**：连续信号 → 离散序列
2. **截断**：无限长 → 有限长 N
3. **周期延拓**：有限长 → 周期序列

### 3.2 DFT 定义

**正变换（DFT）：**
```
X[k] = Σ(n=0 to N-1) x[n] · e^(-j2πkn/N), k = 0, 1, ..., N-1
```

**逆变换（IDFT）：**
```
x[n] = (1/N) Σ(k=0 to N-1) X[k] · e^(j2πkn/N), n = 0, 1, ..., N-1
```

**记号说明：**
- `x[n]`：时域离散序列，长度 N
- `X[k]`：频域离散序列，长度 N
- `n`：时间索引
- `k`：频率索引（频率 = k·fs/N）

### 3.3 物理意义

DFT 将 N 点时域序列分解为 N 个复指数信号：

```
x[n] = (1/N) Σ(k=0 to N-1) X[k] · e^(j2πkn/N)
```

其中每个分量：
- **频率**：ωk = 2πk/N（归一化）
- **幅度**：|X[k]|/N
- **相位**：∠X[k]

### 3.4 频率索引的含义

对于采样频率 `fs` 和序列长度 N：

- **频率分辨率**：Δf = fs/N
- **第 k 个频率**：fk = k·fs/N
- **最高频率**：fmax = fs/2（Nyquist 频率）

**示例：**
- fs = 1000 Hz, N = 8
- Δf = 1000/8 = 125 Hz
- 频率点：0, 125, 250, 375, 500, 625, 750, 875 Hz

### 3.5 DFT 矩阵形式

```
X = W · x

其中：
X = [X[0], X[1], ..., X[N-1]]^T
x = [x[0], x[1], ..., x[N-1]]^T
W[N×N] 是 DFT 矩阵，元素为 W[k,n] = e^(-j2πkn/N)
```

---

## 4. DFT 的性质

### 4.1 线性性

```
DFT{ax[n] + by[n]} = aX[k] + bY[k]
```

### 4.2 循环移位

```
DFT{x[(n-m) mod N]} = e^(-j2πkm/N) · X[k]
```

### 4.3 循环卷积

```
DFT{x[n] ⊛ y[n]} = X[k] · Y[k]

其中循环卷积：
(x ⊛ y)[n] = Σ(m=0 to N-1) x[m] · y[(n-m) mod N]
```

### 4.4 对称性

对于实数序列 x[n]：
- **共轭对称**：X[k] = X*[N-k]
- **实部偶对称**：Re{X[k]} = Re{X[N-k]}
- **虚部奇对称**：Im{X[k]} = -Im{X[N-k]}
- **幅度偶对称**：|X[k]| = |X[N-k]|
- **相位奇对称**：∠X[k] = -∠X[N-k]

### 4.5 Parseval 定理

```
Σ(n=0 to N-1) |x[n]|² = (1/N) Σ(k=0 to N-1) |X[k]|²
```

物理意义：时域能量 = 频域能量

### 4.6 零频率分量（DC 分量）

```
X[0] = Σ(n=0 to N-1) x[n]
```

这是信号的平均值（直流分量）乘以 N。

---

## 5. DFT 计算示例

### 5.1 示例 1：简单序列

**问题**：计算 x[n] = {1, 2, 3, 4} 的 4 点 DFT

**解答：**

```
N = 4
X[k] = Σ(n=0 to 3) x[n] · e^(-j2πkn/4)
     = Σ(n=0 to 3) x[n] · e^(-jπkn/2)
```

使用欧拉公式：e^(-jπkn/2) = cos(πkn/2) - jsin(πkn/2)

**k = 0:**
```
X[0] = 1 + 2 + 3 + 4 = 10
```

**k = 1:**
```
X[1] = 1·e^0 + 2·e^(-jπ/2) + 3·e^(-jπ) + 4·e^(-j3π/2)
     = 1·1 + 2·(-j) + 3·(-1) + 4·(j)
     = (1 - 3) + j(-2 + 4)
     = -2 + j2
```

**k = 2:**
```
X[2] = 1·1 + 2·e^(-jπ) + 3·e^(-j2π) + 4·e^(-j3π)
     = 1 - 2 + 3 - 4
     = -2
```

**k = 3:**
```
X[3] = 1·1 + 2·e^(-j3π/2) + 3·e^(-j3π) + 4·e^(-j9π/2)
     = 1 + 2·(j) + 3·(-1) + 4·(-j)
     = (1 - 3) + j(2 - 4)
     = -2 - j2
```

**结果：**
```
X[k] = {10, -2+j2, -2, -2-j2}
```

验证对称性（实序列）：
- X[1] 与 X[3] 共轭：(-2+j2)* = -2-j2 ✓
- 实部对称：Re{X[1]} = Re{X[3]} = -2 ✓
- 虚部反对称：Im{X[1]} = -Im{X[3]} = 2 ✓

### 5.2 示例 2：余弦信号

**问题**：x[n] = cos(2π·2·n/8)，n = 0, 1, ..., 7

**解答：**

序列值：
```
n:     0    1    2    3    4    5    6    7
x[n]:  1    0   -1    0    1    0   -1    0
```

**物理直觉：**
这是一个频率为 k=2 的纯余弦波，理论上 DFT 应该在 k=2 和 k=6（N-k=8-2=6）处有非零值。

**DFT 结果：**
```
X[2] = 4  （k=2 处的谱线）
X[6] = 4  （k=6=N-2 处的谱线）
X[k≠2,6] = 0
```

这验证了：
- 单频信号在频域是离散的冲激
- 实信号的频谱关于 N/2 对称

---

## 练习题

### 基础练习

1. **计算 DFT**
   计算 x[n] = {1, 0, -1, 0} 的 4 点 DFT。

2. **验证 Parseval 定理**
   对于 x[n] = {1, 2, 3, 4}，验证时域能量和频域能量相等。

3. **频率索引**
   对于 fs = 8 kHz, N = 16：
   - 频率分辨率是多少？
   - k = 3 对应的实际频率是多少？
   - 实际可分析的最高频率是多少？

### 进阶练习

4. **移位性质**
   计算 x[n] = {0, 1, 2, 3} 的 DFT（是例 1 的循环移位）。

5. **对称性验证**
   对于任意实序列 x[n]，证明 X[k] = X*[N-k]。

6. **卷积计算**
   用 DFT 计算 x[n] = {1, 2} 和 h[n] = {1, 1} 的循环卷积。

### 挑战练习

7. **频谱泄漏**
   对于 x[n] = cos(2π·2.5·n/8)，n = 0, ..., 7，计算 DFT 并解释为什么频谱不是纯净的单根谱线。

8. **设计题**
   设计一个长度为 8 的滤波器，使其只保留频率为 2π·3/8 的成分。

---

## 总结

本章节介绍了傅里叶变换的核心理论：

1. **傅里叶级数**：周期函数 → 正弦波叠加
2. **连续傅里叶变换**：非周期信号的频域表示
3. **离散傅里叶变换（DFT）**：计算机可实现的频域分析
4. **DFT 性质**：线性、对称性、卷积定理等
5. **计算示例**：手工计算简单 DFT，理解频谱含义

**下一步**：学习 FFT 算法，了解如何高效计算 DFT。

---

## 参考资源

- 《数字信号处理》- Oppenheim & Schafer
- 《离散时间信号处理》- Oppenheim
- [3Blue1Brown - 傅里叶变换可视化](https://www.youtube.com/watch?v=r6sGWTCMz2k)
- [BetterExplained - 傅里叶变换直观理解](https://betterexplained.com/articles/an-interactive-guide-to-the-fourier-transform/)
